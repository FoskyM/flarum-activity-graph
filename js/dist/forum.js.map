{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@foskym/flarum-activity-graph/webpack/bootstrap","webpack://@foskym/flarum-activity-graph/webpack/runtime/compat get default export","webpack://@foskym/flarum-activity-graph/webpack/runtime/define property getters","webpack://@foskym/flarum-activity-graph/webpack/runtime/hasOwnProperty shorthand","webpack://@foskym/flarum-activity-graph/webpack/runtime/make namespace object","webpack://@foskym/flarum-activity-graph/external root \"flarum.core.compat['common/app']\"","webpack://@foskym/flarum-activity-graph/./src/common/index.ts","webpack://@foskym/flarum-activity-graph/external root \"flarum.core.compat['forum/app']\"","webpack://@foskym/flarum-activity-graph/external root \"flarum.core.compat['common/extend']\"","webpack://@foskym/flarum-activity-graph/external root \"flarum.core.compat['forum/components/UserPage']\"","webpack://@foskym/flarum-activity-graph/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@foskym/flarum-activity-graph/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@foskym/flarum-activity-graph/external root \"flarum.core.compat['common/components/Select']\"","webpack://@foskym/flarum-activity-graph/./src/forum/pages/GraphPage.js","webpack://@foskym/flarum-activity-graph/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@foskym/flarum-activity-graph/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@foskym/flarum-activity-graph/./src/forum/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/app'];","import app from 'flarum/common/app';\n\napp.initializers.add('foskym/flarum-activity-graph', () => {\n  console.log('[foskym/flarum-activity-graph] Hello, forum and admin!');\n});\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/UserPage'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Select'];","import app from 'flarum/forum/app';\r\nimport UserPage from 'flarum/forum/components/UserPage';\r\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\r\nimport Select from 'flarum/common/components/Select';\r\n\r\nexport default class AuthorizedPage extends UserPage {\r\n  loading = true;\r\n  year = new Date().getFullYear().toString();\r\n  graphData = null;\r\n  graph = null;\r\n  resize_handler_bound = false;\r\n  oninit(vnode) {\r\n    super.oninit(vnode);\r\n    this.loadUser(m.route.param('username'));\r\n    this.loadGraph();\r\n  }\r\n\r\n  loadGraph() {\r\n    this.loading = true;\r\n\r\n    app.request({\r\n      method: 'GET',\r\n      url: app.forum.attribute('apiUrl') + '/activity-graph',\r\n      params: {user_id: this.user.id(), year: this.year},\r\n    }).then(result => {\r\n      this.loading = false;\r\n      this.graphData = result;\r\n      this.renderGraph();\r\n    });\r\n  }\r\n\r\n  renderGraph() {\r\n    if (!window.echarts) {\r\n      setTimeout(() => this.renderGraph(), 200);\r\n      return;\r\n    }\r\n\r\n    const graph_container = document.getElementById('activity-graph');\r\n    if (!graph_container) return;\r\n\r\n    this.chart = this.chart || window.echarts.init(graph_container) ;\r\n    this.chart.setOption({\r\n      tooltip: {\r\n        position: \"top\",\r\n        formatter: function(e) {\r\n          return \"<p>\" + e.marker + e.data[0].substring(5) + \" <b>\" + e.data[1] +\r\n            ' ' + 'æ¬¡' + \"</b></p>\"\r\n        }\r\n      },\r\n      visualMap: {\r\n        show: !1,\r\n        min: 0,\r\n        max: 300,\r\n        calculable: !0,\r\n        orient: \"horizontal\",\r\n        left: \"center\",\r\n        top: \"top\",\r\n        inRange: {\r\n          color: [\"#75ca67\", \"#23b20c\", \"#b99f11\", \"#b81111\", \"#6c0b0b\", \"#000000\"]\r\n        }\r\n      },\r\n      calendar: [{\r\n        range: this.year,\r\n        cellSize: [\"auto\", \"auto\"],\r\n        left: 50,\r\n        top: 30,\r\n        splitLine: {\r\n          lineStyle: {\r\n            color: \"#777\"\r\n          }\r\n        },\r\n        dayLabel: {\r\n          nameMap: \"cn\",\r\n          firstDay: 1\r\n        },\r\n        monthLabel: {\r\n          nameMap: \"cn\"\r\n        },\r\n        yearLabel: {\r\n          show: !0\r\n        }\r\n      }],\r\n      series: [{\r\n        type: \"heatmap\",\r\n        coordinateSystem: \"calendar\",\r\n        calendarIndex: 0,\r\n        data: this.graphData\r\n      }]\r\n    });\r\n\r\n    if (!this.resize_handler_bound) {\r\n      window.addEventListener('resize', () => {\r\n        this.chart.resize();\r\n      });\r\n      this.resize_handler_bound = true;\r\n    }\r\n  }\r\n  content() {\r\n    let options = {};\r\n    for (let i = 0; i < 10; i++) {\r\n      let year = (new Date().getFullYear() - i).toString();\r\n      options[year] = year;\r\n    }\r\n\r\n    return <div class=\"activity-graph-page\">\r\n      <Select\r\n        options={\r\n          options\r\n        }\r\n        value={this.year}\r\n        onchange={value => {\r\n          this.year = value;\r\n          this.loadGraph();\r\n        }\r\n      }>\r\n      </Select>\r\n      <div id=\"activity-graph\" style=\"width:100%; height:150px;\"></div>\r\n    </div>;\r\n\r\n  }\r\n\r\n}\r\n","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LinkButton'];","import app from 'flarum/forum/app';\nimport {extend} from 'flarum/common/extend';\nimport UserPage from 'flarum/forum/components/UserPage';\nimport GraphPage from \"./pages/GraphPage\";\nimport LinkButton from 'flarum/common/components/LinkButton';\napp.initializers.add('foskym/flarum-activity-graph', () => {\n  app.routes['user.activity-graph'] = {\n    path: '/u/:username/activity-graph',\n    component: GraphPage\n  };\n  extend(UserPage.prototype, 'navItems', function (items) {\n    items.add(\n      'activity-graph',\n      LinkButton.component(\n        {\n          href: app.route('user.activity-graph', { username: this.user.username() }),\n          icon: 'fas fa-chart-line',\n        },\n        [\n          app.translator.trans('foskym-activity-graph.forum.label.activity_graph'),\n        ]\n      )\n    );\n  });\n});\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","app","add","console","log","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","AuthorizedPage","_UserPage","subClass","superClass","_this","_len","arguments","length","args","Array","_key","apply","concat","loading","year","Date","getFullYear","toString","graphData","graph","resize_handler_bound","create","constructor","_proto","oninit","vnode","this","loadUser","m","route","param","loadGraph","_this2","method","url","attribute","params","user_id","user","id","then","result","renderGraph","_this3","window","echarts","graph_container","document","getElementById","chart","init","setOption","tooltip","position","formatter","e","marker","data","substring","visualMap","show","min","max","calculable","orient","left","top","inRange","color","calendar","range","cellSize","splitLine","lineStyle","dayLabel","nameMap","firstDay","monthLabel","yearLabel","series","type","coordinateSystem","calendarIndex","addEventListener","resize","setTimeout","content","_this4","options","i","class","Select","onchange","style","UserPage","path","component","GraphPage","extend","items","LinkButton","href","username","icon","trans"],"sourceRoot":""}